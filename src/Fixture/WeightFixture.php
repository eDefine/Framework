<?php

namespace Fixture;

use Edefine\Framework\Fixture\AbstractFixture;
use Entity\Weight;

class WeightFixture extends  AbstractFixture
{
    public function getOrder()
    {
        return 8;
    }

    public function load()
    {
        /** @var \Edefine\Framework\ORM\EntityManager $manager */
        $manager = $this->getContainer()->get('manager');

        $weights = [
            '2015-03-03' => 93.7,
            '2015-03-04' => 93.8,
            '2015-03-05' => 93.3,
            '2015-03-06' => 92.9,
            '2015-03-07' => ['value' => 92.0, 'info' => 'Świebodzice'],
            '2015-03-08' => ['value' => 93.0, 'info' => 'Świebodzice'],
            '2015-03-09' => 92.9,
            '2015-03-10' => 92.7,
            '2015-03-11' => 92.5,
            '2015-03-12' => 92.1,
            '2015-03-13' => 92.4,
            '2015-03-23' => 92.5,
            '2015-03-24' => 92.3,
            '2015-03-25' => 92.3,
            '2015-03-26' => 92.2,
            '2015-03-27' => 91.7,
            '2015-03-30' => 91.3,
            '2015-03-31' => 91.2,

            '2015-04-01' => 91.3,
            '2015-04-02' => 90.6,
            '2015-04-03' => 90.5,
            '2015-04-07' => 90.9,
            '2015-04-08' => 90.9,
            '2015-04-09' => 90.9,
            '2015-04-10' => 90.9,
            '2015-04-13' => 91.6,
            '2015-04-14' => 91.3,
            '2015-04-15' => 91.1,
            '2015-04-16' => 90.8,
            '2015-04-20' => 90.5,
            '2015-04-21' => 90.1,
            '2015-04-22' => 90.3,
            '2015-04-23' => 89.8,
            '2015-04-24' => 90.6,
            '2015-04-26' => 89.8,
            '2015-04-27' => 89.3,
            '2015-04-28' => 89.0,
            '2015-04-29' => 88.8,
            '2015-04-30' => 89.2,

            '2015-05-03' => 90.0,
            '2015-05-04' => 89.0,
            '2015-05-05' => 88.9,
            '2015-05-06' => 88.4,
            '2015-05-07' => 88.3,
            '2015-05-10' => 88.3,
            '2015-05-11' => 88.0,
            '2015-05-12' => 87.4,
            '2015-05-13' => 87.8,
            '2015-05-14' => 87.7,
            '2015-05-15' => 87.7,
            '2015-05-17' => 87.0,
            '2015-05-18' => 87.4,
            '2015-05-19' => 87.7,
            '2015-05-20' => 86.8,
            '2015-05-21' => 86.7,
            '2015-05-22' => 86.6,
            '2015-05-25' => 87.0,
            '2015-05-26' => 87.0,
            '2015-05-27' => 86.7,
            '2015-05-28' => 86.0,
            '2015-05-29' => 86.0,

            '2015-06-01' => 85.8,
            '2015-06-02' => 85.8,
            '2015-06-03' => 85.6,
            '2015-06-04' => 85.2,
            '2015-06-05' => 84.9,
            '2015-06-08' => ['value' => 86.3, 'info' => 'Spotkanie z Amelią: 2 piwa, lody, naleśnik'],
            '2015-06-09' => 85.2,
            '2015-06-10' => 84.3,
            '2015-06-11' => 83.9,
            '2015-06-12' => 84.3,
            '2015-06-15' => 84.6,
            '2015-06-16' => 84.2,
            '2015-06-17' => 83.3,
            '2015-06-18' => 83.3,
            '2015-06-19' => 83.0
        ];

        foreach ($weights as $date => $params) {
            if (is_array($params)) {
                $value = $params['value'];
                $info = $params['info'];
            } else {
                $value = $params;
                $info = null;
            }

            $weight = $this->createWeight(1, $value, $date, $info);
            $manager->save($weight);
        }
    }

    private function createWeight($userId, $value, $date, $info)
    {
        $weight = new Weight();

        $weight
            ->setUserId($userId)
            ->setDate(new \DateTime($date))
            ->setValue($value)
            ->setInfo($info);

        return $weight;
    }
}